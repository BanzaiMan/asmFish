version: 1.{build}

image:
- Ubuntu
- Visual Studio 2015

platform:
  - x64
  
matrix:
  fast_finish: false

build_script:
- cmd: for /f \"tokens=2 delims==\" %%a in ('wmic OS Get localdatetime /value') do set \"dt=%%a\"\nset \"YY=%dt:~2,2%\" & set \"YYYY=%dt:~0,4%\" & set \"MM=%dt:~4,2%\" & set \"DD=%dt:~6,2%\"\nset \"datestamp=%YYYY%-%MM%-%DD%\"\necho %datestamp%> out.txt

test_script:
- ps: |
    if ($isLinux) 
    {
      Write-Host "This is Linux!"
      .\fasmg
    }
    else
    {
      $a = "out.txt"
      cd WindowsOS_binaries
      .\asmFishW_${a}_bmi2.exe bench
      .\asmFishW_${a}_popcnt.exe bench
      .\asmFishW_${a}_base.exe bench
      cd..
    }

artifacts:
- path: WindowsOS_binaries
  name: Windows
- path: Matefinder_binaries
  name: Matefinder
- path: LinuxOS_binaries
  name: Linux
- path: MacOS_binaries
  name: Mac
