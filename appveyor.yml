version: 1.{build}

image:
- Ubuntu
- Visual Studio 2015

platform:
  - x64
  
matrix:
  fast_finish: false

build_script:
- ps: |
    if ($isLinux) {
      Write-Host "This is Linux!"
      .\fasmg.exe
      .\fasmg
    } else {
      Write-Host "This is NOT a Linux!"
      .\fasmg.exe
    }

test_script:
- cmd: >-
    cd WindowsOS_binaries
            asmFishW_%datestamp%_bmi2.exe bench
            asmFishW_%datestamp%_popcnt.exe bench
            asmFishW_%datestamp%_base.exe bench
            cd..
    
    cd Matefinder_binaries
            mateFishW_%datestamp%_bmi2.exe bench
            mateFishW_%datestamp%_popcnt.exe bench
            mateFishW_%datestamp%_base.exe bench
            cd..

artifacts:
- path: WindowsOS_binaries
  name: Windows
- path: Matefinder_binaries
  name: Matefinder
- path: LinuxOS_binaries
  name: Linux
- path: MacOS_binaries
  name: Mac
